---
import type { MarkProps } from 'astro-portabletext/types';
import { sanityClient } from 'sanity:client';

type Props = MarkProps<{ article: { _ref: string } }>;

const { node } = Astro.props;

// Fetch article data from Sanity
const articleQuery = `*[_type == "article" && _id == $id][0]{
  title,
  slug
}`;

const article = await sanityClient.fetch(articleQuery, {
  id: node.markDef.article._ref,
});

const href = `/articles/${article.slug.current}`;
---

<a
  href={href}
  class="text-blue-600 underline decoration-blue-300 transition-colors duration-200 hover:text-blue-800 hover:decoration-blue-500"
  title={`Link to: ${article.title}`}><slot /></a
>
